# 2021ä¸­å›½é«˜æ ¡è®¡ç®—æœºå¤§èµ›-å¾®ä¿¡å¤§æ•°æ®æŒ‘æˆ˜èµ›Baselineï¼ˆPytorchç‰ˆï¼‰

ä»£ç å®ç°åŸºäº[DeepCTR](https://github.com/shenweichen/DeepCTR-Torch)ï¼Œåªåšäº†ç®€å•æ•°æ®é¢„å¤„ç†ï¼Œé‡‡ç”¨çš„æ˜¯åŸºæœ¬ç‰¹å¾ï¼ˆç¦»æ•£ç‰¹å¾ï¼š{'userid', 'feedid', 'authorid', 'bgm_song_id', 'bgm_singer_id'}ï¼Œè¿ç»­ç‰¹å¾ï¼š{'videoplayseconds'}ï¼‰ï¼Œå•ä¸ªä»»åŠ¡é€ä¸ªé¢„æµ‹ï¼Œå¤§å®¶å¯ä»¥å°è¯•æ”¹è¿›åŸæœ‰çš„æ¨¡å—ï¼Œå¹¶å°è¯•æ–°çš„æ¨¡å‹å’Œæ–°çš„å»ºæ¨¡æ–¹æ³•ã€‚
baselineçº¯ä¸ºå­¦ä¹ å’Œå‚è€ƒï¼Œæœ‰ä»€ä¹ˆåšçš„ä¸å¯¹çš„åœ°æ–¹ï¼Œè¿˜è¯·å¤§ä½¬ä»¬æ‰¹è¯„å’ŒæŒ‡æ­£ğŸ˜„

## 1.ç¯å¢ƒé…ç½®
- python3
- torch 1.6
- deepctr-torch 0.2.6
- pandas 1.0.1
- scikit-learn 0.22.1

## 2.è¿è¡Œé…ç½®
- CPU/GPUå‡å¯
- æœ€å°å†…å­˜è¦æ±‚
  - ç‰¹å¾/æ ·æœ¬ç”Ÿæˆï¼š6G
  - æ¨¡å‹è®­ç»ƒåŠè¯„ä¼°ï¼š4G

## 3.ç›®å½•ç»“æ„
- prepare_data.py æ•°æ®é›†ç”Ÿæˆ
- baseline.py: æ¨¡å‹è®­ç»ƒï¼Œè¯„ä¼°ï¼Œæäº¤

## 4.è¿è¡Œæµç¨‹
- æ–°å»ºdataç›®å½•ï¼Œä¸‹è½½æ¯”èµ›æ•°æ®é›†ï¼Œæ”¾åœ¨dataç›®å½•ä¸‹å¹¶è§£å‹ï¼Œå¾—åˆ°wechat_algo_data1ç›®å½•
- æ•°æ®é›†ç”Ÿæˆï¼šè¿è¡Œprepare_data.py
- æ¨¡å‹è®­ç»ƒï¼Œè¯„ä¼°ï¼Œæäº¤ï¼šè¿è¡Œbaseline.py

## 5.æ¨¡å‹åŠå‚æ•°
æ¨¡å‹ï¼šDeepFM

å‚æ•°ï¼š
batch_size: 512

optim: Adagrad

num_epochs: 5

learning_rate: 0.1


## 6.æ¨¡å‹ç»“æœ
æˆ‘çš„çº¿ä¸‹éªŒè¯é›†è¯„ä»·æŒ‡æ ‡è¿˜æ²¡æœ‰æ”¹æˆå’Œå®˜ç½‘ä¸€è‡´çš„æ–¹æ³•ï¼Œæ‰€ä»¥å‚è€ƒæ„ä¹‰ä¸å¤§ï¼Œéœ€è¦å¤§å®¶é‡å†™è¯„ä¼°æ–¹æ³•

çº¿ä¸Šï¼š
| weight_uauc | read_comment | like    | click_avatar | forward  |
| ----------- | ------------ | ------- | ------------ | -------- |
| 0.640712    | 0.624132     | 0.61151 | 0.705983     | 0.664097 |

## 7.ç›¸å…³æ–‡çŒ®
Guo H, Tang R, Ye Y, et al. Deepfm: a factorization-machine based neural network for ctr prediction[J]. arXiv preprint arXiv:1703.04247, 2017.
